[
  {
    "suite": "unit",
    "command": "npm run test:unit",
    "critical": true,
    "timestamp": "2025-06-15T11:07:00.588Z",
    "duration": 2129,
    "passed": false,
    "errors": [
      {
        "type": "jest",
        "test": "Email Service › sendWelcomeEmail › should send welcome email with correct template and data",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/emailService.test.js:26:40)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Email Service › sendWelcomeEmail › should handle invalid template gracefully",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/emailService.test.js:56:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/emailService.test.js:63:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Email Service › sendWelcomeEmail › should retry failed email deliveries",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/emailService.test.js:82:40)\n\nFAIL tests/unit/server/utils/validation.test.js",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Server Validation Utilities › Email Validation › should reject invalid email formats",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: false\n    Received: true\n\n       96 |\n       97 |       invalidEmails.forEach(email => {\n    >  98 |         expect(validationUtils.validateEmail(email)).toBe(false);\n          |                                                      ^\n       99 |       });\n      100 |     });\n      101 |   });\n\n      at toBe (unit/server/utils/validation.test.js:98:54)\n          at Array.forEach (<anonymous>)\n      at Object.forEach (unit/server/utils/validation.test.js:97:21)",
        "file": "unit/server/utils/validation.test.js"
      },
      {
        "type": "jest",
        "test": "Server Validation Utilities › Input Sanitization › should sanitize potentially dangerous input",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"scriptalert(\\\"xss\\\")/script\"\n    Received: \"scriptalert(xss)/script\"\n\n      211 |\n      212 |       testCases.forEach(({ input, expected }) => {\n    > 213 |         expect(validationUtils.sanitizeInput(input)).toBe(expected);\n          |                                                      ^\n      214 |       });\n      215 |     });\n      216 |\n\n      at toBe (unit/server/utils/validation.test.js:213:54)\n          at Array.forEach (<anonymous>)\n      at Object.forEach (unit/server/utils/validation.test.js:212:17)\n\nFAIL tests/unit/services/edgeCases.test.js",
        "file": "unit/server/utils/validation.test.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Boundary Value Testing › should handle empty strings gracefully",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:19:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:23:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Boundary Value Testing › should handle maximum length inputs",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:38:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:42:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Boundary Value Testing › should handle special characters in inputs",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:57:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:61:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Boundary Value Testing › should handle unicode and emoji in text fields",
        "message": "Failed to submit form data: Network Error: axios is not a function\n\n      196 |       return response;\n      197 |     } catch (error) {\n    > 198 |       throw new Error(`Failed to submit form data: ${error.message}`);\n          |             ^\n      199 |     }\n      200 |   }\n      201 |\n\n      at TestHelpers.submitFormData (utils/testHelpers.js:198:13)\n      at Object.<anonymous> (unit/services/edgeCases.test.js:82:22)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Null and Undefined Handling › should handle null values in optional fields",
        "message": "Failed to submit form data: Network Error: axios is not a function\n\n      196 |       return response;\n      197 |     } catch (error) {\n    > 198 |       throw new Error(`Failed to submit form data: ${error.message}`);\n          |             ^\n      199 |     }\n      200 |   }\n      201 |\n\n      at TestHelpers.submitFormData (utils/testHelpers.js:198:13)\n      at Object.<anonymous> (unit/services/edgeCases.test.js:106:22)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Null and Undefined Handling › should reject null values in required fields",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Failed to submit form data: Network Error: axios is not a function\"\n\n          196 |       return response;\n          197 |     } catch (error) {\n        > 198 |       throw new Error(`Failed to submit form data: ${error.message}`);\n              |             ^\n          199 |     }\n          200 |   }\n          201 |\n\n      at TestHelpers.submitFormData (utils/testHelpers.js:198:13)\n      at Object.<anonymous> (unit/services/edgeCases.test.js:126:7)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:128:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Date and Time Edge Cases › should handle various date formats",
        "message": "expect(received).toContain(expected) // indexOf\n\n    Expected substring: \"API Error\"\n    Received string:    \"Failed to submit form data: Network Error: axios is not a function\"\n\n      160 |         } catch (error) {\n      161 |           // Some formats might be rejected\n    > 162 |           expect(error.message).toContain('API Error');\n          |                                 ^\n      163 |         }\n      164 |       }\n      165 |     });\n\n      at Object.toContain (unit/services/edgeCases.test.js:162:33)",
        "file": "unit/services/edgeCases.test.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Date and Time Edge Cases › should handle future dates appropriately",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Failed to submit form data: Network Error: axios is not a function\"\n\n          196 |       return response;\n          197 |     } catch (error) {\n        > 198 |       throw new Error(`Failed to submit form data: ${error.message}`);\n              |             ^\n          199 |     }\n          200 |   }\n          201 |\n\n      at TestHelpers.submitFormData (utils/testHelpers.js:198:13)\n      at Object.<anonymous> (unit/services/edgeCases.test.js:180:7)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:182:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Date and Time Edge Cases › should handle leap year dates",
        "message": "Failed to submit form data: Network Error: axios is not a function\n\n      196 |       return response;\n      197 |     } catch (error) {\n    > 198 |       throw new Error(`Failed to submit form data: ${error.message}`);\n          |             ^\n      199 |     }\n      200 |   }\n      201 |\n\n      at TestHelpers.submitFormData (utils/testHelpers.js:198:13)\n      at Object.<anonymous> (unit/services/edgeCases.test.js:196:22)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Concurrent Operation Edge Cases › should handle duplicate submissions gracefully",
        "message": "expect(received).toBeGreaterThanOrEqual(expected)\n\n    Expected: >= 1\n    Received:    0\n\n      228 |       // At least one should succeed\n      229 |       const successes = results.filter(r => r.status === 'fulfilled');\n    > 230 |       expect(successes.length).toBeGreaterThanOrEqual(1);\n          |                                ^\n      231 |       \n      232 |       // If both succeed, they should have different IDs\n      233 |       if (successes.length === 2) {\n\n      at Object.toBeGreaterThanOrEqual (unit/services/edgeCases.test.js:230:32)",
        "file": "unit/services/edgeCases.test.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Concurrent Operation Edge Cases › should handle rapid status checks",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: 10\n    Received: 0\n\n      248 |       \n      249 |       // All should succeed\n    > 250 |       expect(successes.length).toBe(10);\n          |                                ^\n      251 |       \n      252 |       // All should return the same status\n      253 |       const statuses = successes.map(r => r.value.data.status);\n\n      at Object.toBe (unit/services/edgeCases.test.js:250:32)",
        "file": "unit/services/edgeCases.test.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Network and Timeout Edge Cases › should handle slow responses gracefully",
        "message": "expect(received).toMatch(expected)\n\n    Expected pattern: /timeout|ECONNABORTED/\n    Received string:  \"Network Error: axios is not a function\"\n\n      283 |       } catch (error) {\n      284 |         // Timeout is also acceptable\n    > 285 |         expect(error.message).toMatch(/timeout|ECONNABORTED/);\n          |                               ^\n      286 |       }\n      287 |     });\n      288 |\n\n      at Object.toMatch (unit/services/edgeCases.test.js:285:31)",
        "file": "unit/services/edgeCases.test.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Network and Timeout Edge Cases › should handle partial responses",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected pattern: /Unexpected end of JSON input|Parse error/\n    Received message: \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:303:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:304:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Authentication Edge Cases › should handle expired tokens appropriately",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 401\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:313:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:318:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Authentication Edge Cases › should handle malformed tokens",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected pattern: /API Error (401|403)/\n    Received message: \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:333:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:338:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › File Upload Edge Cases › should handle empty file uploads",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:348:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:355:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › File Upload Edge Cases › should reject files exceeding size limits",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 413\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:365:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:372:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › File Upload Edge Cases › should handle unsupported file types",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 415\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:381:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:388:17)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Edge Case Testing › Database Transaction Edge Cases › should rollback on partial failures",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (unit/services/edgeCases.test.js:417:21)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (unit/services/edgeCases.test.js:421:17)\n\nFAIL tests/unit/lib/supabase.test.js",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "Supabase Client Configuration › Client Configuration › should create server-side client with correct configuration",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"https://test.supabase.co\"\n    Received: undefined\n\n      55 |       \n      56 |       expect(supabase).toBeDefined();\n    > 57 |       expect(supabase.supabaseUrl).toBe('https://test.supabase.co');\n         |                                    ^\n      58 |       expect(supabase.supabaseKey).toBe('test-service-key');\n      59 |     });\n      60 |\n\n      at Object.toBe (unit/lib/supabase.test.js:57:36)",
        "file": "unit/lib/supabase.test.js"
      },
      {
        "type": "jest",
        "test": "Supabase Client Configuration › Client Configuration › should create client-side client with correct configuration",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"https://test.supabase.co\"\n    Received: undefined\n\n      63 |       \n      64 |       expect(supabaseClient).toBeDefined();\n    > 65 |       expect(supabaseClient.supabaseUrl).toBe('https://test.supabase.co');\n         |                                          ^\n      66 |       expect(supabaseClient.supabaseKey).toBe('test-public-anon-key');\n      67 |     });\n      68 |\n\n      at Object.toBe (unit/lib/supabase.test.js:65:42)",
        "file": "unit/lib/supabase.test.js"
      },
      {
        "type": "jest",
        "test": "Supabase Client Configuration › Client Configuration › should use SUPABASE_ANON_KEY as fallback for client",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"test-anon-key\"\n    Received: undefined\n\n      73 |       const { supabaseClient } = require('../../../lib/supabase.js');\n      74 |       \n    > 75 |       expect(supabaseClient.supabaseKey).toBe('test-anon-key');\n         |                                          ^\n      76 |     });\n      77 |   });\n      78 |\n\n      at Object.toBe (unit/lib/supabase.test.js:75:42)",
        "file": "unit/lib/supabase.test.js"
      },
      {
        "type": "jest",
        "test": "Supabase Client Configuration › Auth Configuration › should configure server client with no auto-refresh",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: false\n    Received: undefined\n\n      82 |       \n      83 |       // Check auth configuration (this depends on Supabase client internals)\n    > 84 |       expect(supabase.auth.autoRefreshToken).toBe(false);\n         |                                              ^\n      85 |     });\n      86 |\n      87 |     it('should configure client with auto-refresh enabled', () => {\n\n      at Object.toBe (unit/lib/supabase.test.js:84:46)",
        "file": "unit/lib/supabase.test.js"
      },
      {
        "type": "jest",
        "test": "Supabase Client Configuration › Auth Configuration › should configure client with auto-refresh enabled",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: true\n    Received: undefined\n\n      89 |       \n      90 |       // Check auth configuration\n    > 91 |       expect(supabaseClient.auth.autoRefreshToken).toBe(true);\n         |                                                    ^\n      92 |     });\n      93 |   });\n      94 | });\n\n      at Object.toBe (unit/lib/supabase.test.js:91:52)\n\nPASS tests/unit/services/requestQueue.test.js\nPASS tests/unit/lib/utilities.test.ts\nPASS tests/unit/lib/aiTranslationService.test.js\nPASS tests/unit/client/services/apiService.test.js\nPASS tests/unit/client/components/LoadingSpinner.test.js\nPASS tests/unit/services/offlineStorage.test.js\nPASS tests/unit/auth/authentication.test.ts\nPASS tests/unit/services/emailServiceSimple.test.js\nPASS tests/unit/auth/managerLoginSimple.test.js\nPASS tests/unit/api/endpoints.test.ts\nPASS tests/unit/basicFunctionality.test.js\nPASS tests/unit/services/workflowService.test.js\nPASS tests/unit/smoke.test.js\nFAIL tests/unit/hooks/useOffline.test.js",
        "file": "unit/lib/supabase.test.js"
      },
      {
        "type": "jest",
        "test": "Test suite failed to run",
        "message": "Cannot find module '../../../client/src/services/offlineStorage' from 'unit/hooks/useOffline.test.js'\n\n      126 |\n      127 | // Mock the services\n    > 128 | jest.mock('../../../client/src/services/offlineStorage', () => ({\n          |      ^\n      129 |   saveQuizProgress: jest.fn(() => true),\n      130 |   getQuizProgress: jest.fn(() => null),\n      131 |   saveCompletedQuiz: jest.fn(() => true),\n\n      at Resolver._throwModNotFoundError (../node_modules/jest-resolve/build/resolver.js:427:11)\n      at Object.mock (unit/hooks/useOffline.test.js:128:6)\n\nFAIL tests/unit/auth/managerLogin.test.js",
        "file": "../node_modules/jest-resolve/build/resolver.js"
      },
      {
        "type": "jest",
        "test": "Test suite failed to run",
        "message": "Cannot find module 'express' from 'unit/auth/managerLogin.test.js'\n\n      13 | const { createClient } = require('@supabase/supabase-js');\n      14 | const request = require('supertest');\n    > 15 | const express = require('express');\n         |                 ^\n      16 |\n      17 | // Mock Supabase\n      18 | jest.mock('@supabase/supabase-js');\n\n      at Resolver._throwModNotFoundError (../node_modules/jest-resolve/build/resolver.js:427:11)\n      at Object.require (unit/auth/managerLogin.test.js:15:17)\n\nJest: \"global\" coverage threshold for statements (15%) not met: 1.93%\nJest: \"global\" coverage threshold for branches (15%) not met: 2.48%\nJest: \"global\" coverage threshold for lines (15%) not met: 2.02%\nJest: \"global\" coverage threshold for functions (20%) not met: 0%\nTest Suites: 6 failed, 13 passed, 19 total\nTests:       29 failed, 204 passed, 233 total\nSnapshots:   0 total\nTime:        1.751 s\nRan all test suites matching /tests\\/unit/i.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?",
        "file": "../node_modules/jest-resolve/build/resolver.js"
      }
    ],
    "output": "\n> maritime-onboarding-system@2.0.0 test:unit\n> jest --config tests/jest.config.js tests/unit\n\n-------------------------|---------|----------|---------|---------|-------------------\nFile                     | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n-------------------------|---------|----------|---------|---------|-------------------\nAll files                |    1.93 |     2.48 |       0 |    2.02 |                   \n aiTranslationService.js |       0 |        0 |       0 |       0 | 10-1289           \n supabase.js             |     100 |      100 |     100 |     100 |                   \n-------------------------|---------|----------|---------|---------|-------------------\n",
    "exitCode": 1
  },
  {
    "suite": "integration",
    "command": "npm run test:integration",
    "critical": true,
    "timestamp": "2025-06-15T11:07:02.717Z",
    "duration": 1390,
    "passed": false,
    "errors": [
      {
        "type": "jest",
        "test": "API Contract Tests › Authentication Endpoints › POST /api/auth/magic-link › should return correct response structure for valid email",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:20:44)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Authentication Endpoints › POST /api/auth/magic-link › should return error for invalid email format",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:37:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:41:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Authentication Endpoints › POST /api/auth/magic-link › should return error for missing email",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:46:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:50:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Authentication Endpoints › GET /api/auth/verify › should verify valid token and return user data",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:57:53)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Authentication Endpoints › GET /api/auth/verify › should return error for invalid token",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 401\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:82:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:83:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Authentication Endpoints › GET /api/auth/verify › should return error for expired token",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 401\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:91:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:92:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Onboarding Endpoints › POST /api/onboarding/form › should accept valid form submission",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:105:44)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Onboarding Endpoints › POST /api/onboarding/form › should validate required form fields",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:130:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:138:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Onboarding Endpoints › POST /api/onboarding/form › should enforce phase sequence",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:143:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:151:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Onboarding Endpoints › GET /api/onboarding/status/:userId › should return onboarding status for valid user",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:157:44)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Onboarding Endpoints › GET /api/onboarding/status/:userId › should return 404 for non-existent user",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 404\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:178:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:179:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › PDF Generation Endpoints › POST /api/pdf/generate › should generate PDF with valid data",
        "message": "Failed to submit form data: Network Error: axios is not a function\n\n      196 |       return response;\n      197 |     } catch (error) {\n    > 198 |       throw new Error(`Failed to submit form data: ${error.message}`);\n          |             ^\n      199 |     }\n      200 |   }\n      201 |\n\n      at TestHelpers.submitFormData (utils/testHelpers.js:198:13)\n      at Object.<anonymous> (integration/api/apiContracts.test.js:193:9)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › PDF Generation Endpoints › POST /api/pdf/generate › should return error for invalid template",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:219:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:226:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › PDF Generation Endpoints › POST /api/pdf/generate › should return error for user without completed onboarding",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:235:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:242:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Manager Dashboard Endpoints › GET /api/manager/crew › should return crew list for manager",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:250:44)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Manager Dashboard Endpoints › GET /api/manager/crew › should return 401 for unauthorized access",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 401\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:274:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:275:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Manager Dashboard Endpoints › GET /api/manager/crew › should return 403 for non-manager role",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 403\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:280:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:285:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Manager Dashboard Endpoints › POST /api/manager/crew › should create new crew member",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:296:44)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Manager Dashboard Endpoints › POST /api/manager/crew › should validate crew member data",
        "message": "expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"API Error 400\"\n    Received message:   \"Network Error: axios is not a function\"\n\n          56 |       // Handle network errors without circular references\n          57 |       const errorMessage = error.code || error.message || 'Network error';\n        > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n             |             ^\n          59 |     }\n          60 |   }\n          61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:320:23)\n      at Object.toThrow (../node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (integration/api/apiContracts.test.js:330:19)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Health Check Endpoints › GET /api/health › should return system health status",
        "message": "Network Error: axios is not a function\n\n      56 |       // Handle network errors without circular references\n      57 |       const errorMessage = error.code || error.message || 'Network error';\n    > 58 |       throw new Error(`Network Error: ${errorMessage}`);\n         |             ^\n      59 |     }\n      60 |   }\n      61 |\n\n      at TestHelpers.apiRequest (utils/testHelpers.js:58:13)\n      at Object.apiRequest (integration/api/apiContracts.test.js:338:44)",
        "file": "utils/testHelpers.js"
      },
      {
        "type": "jest",
        "test": "API Contract Tests › Error Response Consistency › should return consistent error format across all endpoints",
        "message": "expect(received).toMatch(expected)\n\n    Expected pattern: /^API Error \\d{3}:/\n    Received string:  \"Network Error: axios is not a function\"\n\n      368 |         } catch (error) {\n      369 |           // All API errors should follow consistent format\n    > 370 |           expect(error.message).toMatch(/^API Error \\d{3}:/);\n          |                                 ^\n      371 |         }\n      372 |       }\n      373 |     });\n\n      at Object.toMatch (integration/api/apiContracts.test.js:370:33)\n\nFAIL tests/integration/real-world-test.test.js",
        "file": "integration/api/apiContracts.test.js"
      },
      {
        "type": "jest",
        "test": "Real-World Integration Tests › Complete Onboarding Workflow › should complete the full crew onboarding process with REAL services",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"testcrew1749985623959@shipdocs.app\"\n    Received: undefined\n\n      189 |         // Verify the complete workflow worked\n      190 |         expect(createdUser).toBeDefined();\n    > 191 |         expect(createdUser.email).toBe(testCrewMember.email);\n          |                                   ^\n      192 |         expect(createdOnboarding).toBeDefined();\n      193 |         expect(createdOnboarding.user_id).toBe(createdUser.id);\n      194 |         expect(updatedUser.status).toBe('completed');\n\n      at Object.toBe (integration/real-world-test.test.js:191:35)",
        "file": "integration/real-world-test.test.js"
      },
      {
        "type": "jest",
        "test": "Real-World Integration Tests › Complete Onboarding Workflow › should handle partial form submission and resume with REAL database",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: 1\n    Received: undefined\n\n      257 |\n      258 |         // Verify the workflow\n    > 259 |         expect(savedData.phase).toBe(1);\n          |                                 ^\n      260 |         expect(savedData.status).toBe('in_progress');\n      261 |         expect(updatedData.phase).toBe(2);\n      262 |         expect(updatedData.status).toBe('completed');\n\n      at Object.toBe (integration/real-world-test.test.js:259:33)",
        "file": "integration/real-world-test.test.js"
      },
      {
        "type": "jest",
        "test": "Real-World Integration Tests › Error Handling and Recovery › should handle email delivery failures gracefully",
        "message": "expect(received).toMatch(expected)\n\n    Expected pattern: /Network Error|Request failed|ECONNREFUSED|404/\n    Received string:  \"expect(received).toBe(expected) // Object.is equality·\n    Expected: 200\n    Received: undefined\"\n\n      297 |       } catch (error) {\n      298 |         // This is expected - the endpoint doesn't exist or email service is down\n    > 299 |         expect(error.message).toMatch(/Network Error|Request failed|ECONNREFUSED|404/);\n          |                               ^\n      300 |         console.log('✅ Email failure handling test completed - service properly unavailable');\n      301 |       }\n      302 |     }, 10000);\n\n      at Object.toMatch (integration/real-world-test.test.js:299:31)",
        "file": "integration/real-world-test.test.js"
      },
      {
        "type": "jest",
        "test": "Real-World Integration Tests › Error Handling and Recovery › should handle PDF generation failures gracefully",
        "message": "expect(received).toMatch(expected)\n\n    Expected pattern: /Network Error|Request failed|ECONNREFUSED|400|404|500/\n    Received string:  \"expect(received).toBe(expected) // Object.is equality·\n    Expected: 200\n    Received: undefined\"\n\n      315 |       } catch (error) {\n      316 |         // This is expected - invalid user ID or template should fail\n    > 317 |         expect(error.message).toMatch(/Network Error|Request failed|ECONNREFUSED|400|404|500/);\n          |                               ^\n      318 |         console.log('✅ PDF failure handling test completed - service properly validates input');\n      319 |       }\n      320 |     }, 10000);\n\n      at Object.toMatch (integration/real-world-test.test.js:317:31)\n\nFAIL tests/integration/auth/authFlow.test.ts",
        "file": "integration/real-world-test.test.js"
      },
      {
        "type": "jest",
        "test": "Authentication Flow Integration › Manager Authentication Flow › should complete full manager login workflow",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: true\n    Received: false\n\n      77 |       const result = await simulateManagerLogin(loginData);\n      78 |\n    > 79 |       expect(result.success).toBe(true);\n         |                              ^\n      80 |       expect(result.user.role).toBe('manager');\n      81 |       expect(result.token).toBeDefined();\n      82 |       expect(mockSupabase.from).toHaveBeenCalledWith('managers');\n\n      at Object.<anonymous> (integration/auth/authFlow.test.ts:79:30)",
        "file": "integration/auth/authFlow.test.ts"
      },
      {
        "type": "jest",
        "test": "Authentication Flow Integration › Manager Authentication Flow › should handle invalid manager credentials",
        "message": "expect(received).toContain(expected) // indexOf\n\n    Expected substring: \"Invalid credentials\"\n    Received string:    \"Cannot read properties of undefined (reading 'error')\"\n\n      102 |\n      103 |       expect(result.success).toBe(false);\n    > 104 |       expect(result.error).toContain('Invalid credentials');\n          |                            ^\n      105 |     });\n      106 |\n      107 |     test('should handle inactive manager accounts', async () => {\n\n      at Object.<anonymous> (integration/auth/authFlow.test.ts:104:28)",
        "file": "integration/auth/authFlow.test.ts"
      },
      {
        "type": "jest",
        "test": "Authentication Flow Integration › Manager Authentication Flow › should handle inactive manager accounts",
        "message": "expect(received).toContain(expected) // indexOf\n\n    Expected substring: \"Account is not active\"\n    Received string:    \"Cannot read properties of undefined (reading 'error')\"\n\n      125 |\n      126 |       expect(result.success).toBe(false);\n    > 127 |       expect(result.error).toContain('Account is not active');\n          |                            ^\n      128 |     });\n      129 |   });\n      130 |\n\n      at Object.<anonymous> (integration/auth/authFlow.test.ts:127:28)",
        "file": "integration/auth/authFlow.test.ts"
      },
      {
        "type": "jest",
        "test": "Authentication Flow Integration › Crew Magic Link Flow › should complete magic link request workflow",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: true\n    Received: false\n\n      154 |       const result = await simulateMagicLinkRequest(requestData);\n      155 |\n    > 156 |       expect(result.success).toBe(true);\n          |                              ^\n      157 |       expect(result.message).toContain('Magic link sent');\n      158 |       expect(mockSupabase.from).toHaveBeenCalledWith('crew_members');\n      159 |       expect(mockEmailService.sendEmail).toHaveBeenCalled();\n\n      at Object.<anonymous> (integration/auth/authFlow.test.ts:156:30)",
        "file": "integration/auth/authFlow.test.ts"
      },
      {
        "type": "jest",
        "test": "Authentication Flow Integration › Crew Magic Link Flow › should handle non-existent crew member",
        "message": "expect(received).toContain(expected) // indexOf\n\n    Expected substring: \"Crew member not found\"\n    Received string:    \"Cannot read properties of undefined (reading 'error')\"\n\n      174 |\n      175 |       expect(result.success).toBe(false);\n    > 176 |       expect(result.error).toContain('Crew member not found');\n          |                            ^\n      177 |     });\n      178 |\n      179 |     test('should complete magic link verification workflow', async () => {\n\n      at Object.<anonymous> (integration/auth/authFlow.test.ts:176:28)",
        "file": "integration/auth/authFlow.test.ts"
      },
      {
        "type": "jest",
        "test": "Authentication Flow Integration › Crew Magic Link Flow › should complete magic link verification workflow",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: true\n    Received: false\n\n      195 |       const result = await simulateMagicLinkVerification(mockToken);\n      196 |\n    > 197 |       expect(result.success).toBe(true);\n          |                              ^\n      198 |       expect(result.user).toEqual(mockCrewData);\n      199 |       expect(result.token).toBeDefined();\n      200 |     });\n\n      at Object.<anonymous> (integration/auth/authFlow.test.ts:197:30)",
        "file": "integration/auth/authFlow.test.ts"
      },
      {
        "type": "jest",
        "test": "Authentication Flow Integration › Password Reset Flow › should complete password reset request",
        "message": "expect(received).toBe(expected) // Object.is equality\n\n    Expected: true\n    Received: false\n\n      267 |       const result = await simulatePasswordResetRequest('manager@test.com');\n      268 |\n    > 269 |       expect(result.success).toBe(true);\n          |                              ^\n      270 |       expect(result.message).toContain('Password reset email sent');\n      271 |       expect(mockEmailService.sendEmail).toHaveBeenCalled();\n      272 |     });\n\n      at Object.<anonymous> (integration/auth/authFlow.test.ts:269:30)",
        "file": "integration/auth/authFlow.test.ts"
      },
      {
        "type": "jest",
        "test": "Authentication Flow Integration › Password Reset Flow › should complete password reset confirmation",
        "message": "TypeError: mockSupabase.from(...).update(...).eq(...).mockResolvedValue is not a function\n\n      279 |\n      280 |       // Mock token validation and password update\n    > 281 |       mockSupabase.from().update().eq().mockResolvedValue({\n          |                                         ^\n      282 |         data: { id: 'manager-id' },\n      283 |         error: null\n      284 |       });\n\n      at Object.<anonymous> (integration/auth/authFlow.test.ts:281:41)\n\nFAIL tests/integration/onboarding/onboardingFlow.test.js",
        "file": "integration/auth/authFlow.test.ts"
      },
      {
        "type": "jest",
        "test": "Test suite failed to run",
        "message": "TypeError: Cannot read properties of undefined (reading 'email')\n\n      124 |       phoneNumber: '+31612345678',\n      125 |       alternativePhone: '+31687654321',\n    > 126 |       email: testUser.email,\n          |                       ^\n      127 |       homeAddress: {\n      128 |         street: 'Test Street 123',\n      129 |         city: 'Amsterdam',\n\n      at email (integration/onboarding/onboardingFlow.test.js:126:23)\n      at describe (integration/onboarding/onboardingFlow.test.js:122:3)\n      at Object.describe (integration/onboarding/onboardingFlow.test.js:4:1)\n\nJest: \"global\" coverage threshold for statements (15%) not met: 12.78%\nJest: \"global\" coverage threshold for branches (15%) not met: 6.66%\nJest: \"global\" coverage threshold for lines (15%) not met: 12.87%\nJest: \"global\" coverage threshold for functions (20%) not met: 10%\nTest Suites: 4 failed, 4 total\nTests:       33 failed, 5 passed, 38 total\nSnapshots:   0 total\nTime:        1.022 s\nRan all test suites matching /tests\\/integration/i.\nForce exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?",
        "file": "integration/onboarding/onboardingFlow.test.js"
      }
    ],
    "output": "\n> maritime-onboarding-system@2.0.0 test:integration\n> jest --config tests/jest.config.js tests/integration\n\n------------------------|---------|----------|---------|---------|-------------------\nFile                    | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n------------------------|---------|----------|---------|---------|-------------------\nAll files               |   12.78 |     6.66 |      10 |   12.87 |                   \n emailServiceFactory.js |    9.01 |        0 |    7.14 |    9.01 | 32-356            \n settingsService.js     |   14.28 |     5.55 |   16.66 |    14.4 | 46-341            \n smtpEmailService.js    |   16.45 |    14.81 |   22.22 |   16.66 | 7-11,60-284       \n storage.js             |    3.12 |        0 |       0 |    3.17 | 7-191             \n supabase.js            |    87.5 |    66.66 |     100 |    87.5 | 8                 \n------------------------|---------|----------|---------|---------|-------------------\n",
    "exitCode": 1
  },
  {
    "suite": "security",
    "command": "npm run test:security",
    "critical": false,
    "timestamp": "2025-06-15T11:07:04.107Z",
    "duration": 1210,
    "passed": true,
    "errors": [],
    "output": "\n> maritime-onboarding-system@2.0.0 test:security\n> npm audit --audit-level=moderate\n\n# npm audit report\n\nbrace-expansion  1.0.0 - 1.1.11 || 2.0.0 - 2.0.1\nbrace-expansion Regular Expression Denial of Service vulnerability - https://github.com/advisories/GHSA-v6h2-p8h4-qcjw\nbrace-expansion Regular Expression Denial of Service vulnerability - https://github.com/advisories/GHSA-v6h2-p8h4-qcjw\nfix available via `npm audit fix`\nnode_modules/brace-expansion\nnode_modules/filelist/node_modules/brace-expansion\n\n1 low severity vulnerability\n\nTo address all issues, run:\n  npm audit fix\n"
  },
  {
    "suite": "lint",
    "command": "npm run lint",
    "critical": false,
    "timestamp": "2025-06-15T11:07:05.317Z",
    "duration": 248,
    "passed": false,
    "errors": [
      {
        "type": "generic",
        "message": "\n> maritime-onboarding-system@2.0.0 lint\n> eslint . --ext .js,.jsx,.ts,.tsx\n\n\nOops! Something went wrong! :(\n\nESLint: 8.57.1\n\nESLint couldn't find the plugin \"@typescript-eslint/eslint-plugin\".\n\n(The package \"@typescript-eslint/eslint-plugin\" was not found when loaded as a Node module from the directory \"/home/martin/Ontwikkeling/new-onboarding-2025\".)\n\nIt's likely that the plugin isn't installed correctly. Try reinstalling by running the following:\n\n    npm install @typescript-eslint/eslint-plugin@latest --save-dev\n\nThe plugin \"@typescript-eslint/eslint-plugin\" was referenced from the config file in \".eslintrc.js#overrides[0]\".\n\nIf you still can't figure out the problem, please stop by https://eslint.org/chat/help to chat with the team.\n\n"
      }
    ],
    "output": "\n> maritime-onboarding-system@2.0.0 lint\n> eslint . --ext .js,.jsx,.ts,.tsx\n\n",
    "exitCode": 2
  },
  {
    "suite": "e2e-smoke",
    "command": "npm run test:e2e:smoke",
    "critical": true,
    "timestamp": "2025-06-15T11:07:05.566Z",
    "duration": 491,
    "passed": false,
    "errors": [
      {
        "type": "generic",
        "message": "\n> maritime-onboarding-system@2.0.0 test:e2e:smoke\n> node e2e-tests/index.js smoke\n\nnode:fs:596\n  handleErrorFromBinding(ctx);\n  ^\n\nError: ENOENT: no such file or directory, open './config.json'\n    at Object.openSync (node:fs:596:3)\n    at Object.readFileSync (node:fs:464:35)\n    at new TestRunner (/home/martin/Ontwikkeling/new-onboarding-2025/e2e-tests/src/TestRunner.js:15:33)\n    at Command.<anonymous> (/home/martin/Ontwikkeling/new-onboarding-2025/e2e-tests/index.js:119:20)\n    at Command.listener [as _actionHandler] (/home/martin/Ontwikkeling/new-onboarding-2025/e2e-tests/node_modules/commander/lib/command.js:494:17)\n    at /home/martin/Ontwikkeling/new-onboarding-2025/e2e-tests/node_modules/commander/lib/command.js:1296:65\n    at Command._chainOrCall (/home/martin/Ontwikkeling/new-onboarding-2025/e2e-tests/node_modules/commander/lib/command.js:1193:12)\n    at Command._parseCommand (/home/martin/Ontwikkeling/new-onboarding-2025/e2e-tests/node_modules/commander/lib/command.js:1296:"
      }
    ],
    "output": "\n> maritime-onboarding-system@2.0.0 test:e2e:smoke\n> node e2e-tests/index.js smoke\n\n",
    "exitCode": 1
  }
]